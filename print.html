<!DOCTYPE HTML>
<html lang="ro" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introducere.html">Introducere</a></li><li class="chapter-item expanded "><a href="retele.html"><strong aria-hidden="true">1.</strong> Retele Neuronale</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="explicatie.html"><strong aria-hidden="true">1.1.</strong> Ce sunt?</a></li><li class="chapter-item expanded "><a href="backprop.html"><strong aria-hidden="true">1.2.</strong> Cum invata?</a></li><li class="chapter-item expanded "><a href="mnist.html"><strong aria-hidden="true">1.3.</strong> De unde invata?</a></li></ol></li><li class="chapter-item expanded "><a href="interfata.html"><strong aria-hidden="true">2.</strong> Interfata Grafica</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="sfml.html"><strong aria-hidden="true">2.1.</strong> SFML</a></li><li class="chapter-item expanded "><a href="widget.html"><strong aria-hidden="true">2.2.</strong> Widgets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="buton.html"><strong aria-hidden="true">2.2.1.</strong> Butoane</a></li><li class="chapter-item expanded "><a href="paintarea.html"><strong aria-hidden="true">2.2.2.</strong> PaintArea</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="imbunatatiri.html"><strong aria-hidden="true">3.</strong> Imbunatatiri</a></li><li class="chapter-item expanded affix "><a href="bibliografie.html">Bibliografie</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#introducere" id="introducere">Introducere</a></h1>
<p>Inteligenta artificale a devenit una din cele mai influentale domenii de cercetare din ultimul secol. Cu ajutorul acesteia, omenirea a ajuns la avansuri tehnologice nemaipomenite:</p>
<ul>
<li>masini care se conduc singure</li>
<li>infrangerea celui mai bun jucator de Go din lume</li>
<li>traducerea textelor cu o precizie uimitoare</li>
</ul>
<p>Desi multa lume se sperie cand aude de inteligenta artificiale, aceasta este inofensiva. La momentul actual, inteligenta artificiala este mai aproape de o functie matematica, decat de Terminator. Si matematica nu a ranit pe nimeni.</p>
<h1><a class="header" href="#retele-neuronale" id="retele-neuronale">Retele Neuronale</a></h1>
<p>In aceasta sectiune voi incerca sa raspund la urmatoarele intrebari:</p>
<ul>
<li>Ce sunt?</li>
<li>Cum invata?</li>
<li>De unde?</li>
</ul>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Colored_neural_network.svg/280px-Colored_neural_network.svg.png" alt="" /></p>
<h1><a class="header" href="#ce-sunt-aceste-retele-neuronale-artificiale" id="ce-sunt-aceste-retele-neuronale-artificiale">Ce sunt aceste Retele Neuronale Artificiale?</a></h1>
<p>Rețelele neurale (RN, în engleză: ANN de la artificial neural network) sunt o ramură din știința inteligenței artificiale, și constituie totodată, principial, un obiect de cercetare și pentru neuroinformatică. Rețelele neurale artificiale caracterizează ansambluri de elemente de procesare simple, puternic interconectate și operând în paralel, care urmăresc să interacționeze cu mediul înconjurător într-un mod asemănător creierelor biologice și care prezintă capacitatea de a învăța. Ele sunt compuse din neuroni artificiali, sunt parte a inteligenței artificiale și își au, concepțional, originea ca și neuronii artificiali, în biologie. Nu există pentru RNA o definiție general acceptată a acestor tipuri de sisteme, dar majoritatea cercetătorilor sunt de acord cu definirea rețelelor neurale artificiale ca rețele de elemente simple puternic interconectate prin intermediul unor legături numite interconexiuni prin care se propagă informație numerică. </p>
<p><img src="https://www.astroml.org/_images/fig_neural_network_1.png" alt="" /></p>
<h1><a class="header" href="#backpropagation" id="backpropagation">Backpropagation</a></h1>
<p>Daca stim care ar trebui sa fie output-ul, atunci putem calcula cat de mult a gresit configuratia actuala a retelei. Acest calcul se numeste functia de cost. Cu cat este mai mare rezultatul functiei, cu atat greseala este mai mare.</p>
<p>Prin urmare, scopul nostru este sa aflam minimul functiei de cost, schimband valorile weight-urilor. Acest lucru este posibil printr-o metoda numita <a href="https://en.wikipedia.org/wiki/Gradient_descent">gradient descent</a>.</p>
<p>Afland \( \frac{\partial C}{\partial w} \) pentru fiecare \(w\), putem afla cum sa modificam \(w\) astfel incat \(C\)(costul) sa fie minim.</p>
<p>Acest algoritm se numeste backpropagation, si asa arata implementarea:</p>
<pre><code class="language-cpp">void neural_network::backpropagate(std::vector&lt;matrix&lt;double&gt;&gt; &amp;input, 
                             const std::vector&lt;matrix&lt;double&gt;&gt; &amp;expected, 
                                   double learnRate)
{
    int m=input.size();
    int L=nrLayers-1;
    std::vector&lt;matrix&lt;double&gt;&gt; delta_B(1);
    std::vector&lt;matrix&lt;double&gt;&gt; delta_W(1);

    for(int i=1;i&lt;=L;i++)
    {
        delta_B.push_back(matrix&lt;double&gt;(layers[i],1));
        delta_W.push_back(matrix&lt;double&gt;(layers[i],layers[i-1]));
    }

    for(int i=0;i&lt;m;i++)
    {
        this-&gt;feedforward(input[i].toVector());
        std::vector&lt;matrix&lt;double&gt;&gt; delta_Z(1);

        for(int j=1;j&lt;=L;j++)
            delta_Z.push_back(matrix&lt;double&gt;(layers[j],1));


        for(int l=L;l&gt;0;l--)
        {
            if(l==L) delta_Z[l]=hadamard(quadratic.delta(this-&gt;getOutput(),expected[i]),
                                         activation[L].delta(neurons[L]));
            else     delta_Z[l]=hadamard(weights[l+1].transpose()*delta_Z[l+1], 
                                         activation[l].delta(neurons[l]));
            delta_B[l]=delta_B[l]+delta_Z[l];
            delta_W[l]=delta_W[l]+outer(delta_Z[l], activation[l-1](neurons[l-1]));
        }
    }

    for(int i=1;i&lt;nrLayers;i++)
    {
        biases[i]=biases[i]-(learnRate/(double)m)*delta_B[i];
        weights[i]=weights[i]-(learnRate/(double)m)*delta_W[i];
    }
}
</code></pre>
<h1><a class="header" href="#de-unde-invata" id="de-unde-invata">De unde invata?</a></h1>
<h2><a class="header" href="#baza-de-date-mnist" id="baza-de-date-mnist">Baza de date MNIST</a></h2>
<p>Baza de date MNIST (Modified National Institute of Standards and Technology database) este o baza de date cu cifre scrise de mana, care este folosit deseori pentru antrenarea unor sisteme de procesare a imaginilor.</p>
<p>Aceste imagini sunt 28x28 pixeli, si prin urmare reteaua neuronala o va avea 28x28 neuroni de input, si 10 neuroni de output (unul pentru fiecare cifra).</p>
<p><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" alt="" /></p>
<h1><a class="header" href="#interfata-grafica" id="interfata-grafica">Interfata Grafica</a></h1>
<p>Interfata grafica este compusa din 5 elemente:</p>
<p><img src="./screenshot.png" alt="" /></p>
<ol>
<li>Locul unde desenezi cifra (cu click stanga desenezi si cu click dreapta stergi)</li>
<li>Butoane cu care schimbi marimea pensulei</li>
<li>Butonul &quot;Clear&quot; care sterge tot ce ai desenat</li>
<li>Butonul &quot;Calculate&quot; care calculeaza ce cifra ai desenat.</li>
<li>Cifra pe care ai desenat-o</li>
</ol>
<h1><a class="header" href="#sfml" id="sfml">SFML</a></h1>
<p>SFML (Simple Fast Multimedia Library) este o librarie open-source si cross-platform de C++ pentru jocuri sau aplicatii multimedia.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/SFML2.svg/1200px-SFML2.svg.png" alt="" /></p>
<h1><a class="header" href="#widgets" id="widgets">Widgets</a></h1>
<p>Un Widget este orice element vizibil si interactiv.</p>
<pre><code class="language-cpp">class Widget : public sf::Drawable
{
public:
    virtual ~Widget() = 0;
    virtual void update() = 0;
    virtual void handleEvent(sf::Event event) = 0;
protected:
//    virtual void draw(sf::RenderTarget &amp;target, sf::RenderStates states) const;
};
</code></pre>
<p>Aplicatia este formata dintr-un vector de Widget-uri.</p>
<pre><code class="language-cpp">
vector&lt;gui::Widget*&gt; widgets;

void Init()
{
    //...
}

void Update()
{
    for(auto w:widgets)
        w-&gt;update();
}

void HandleEvents()
{
    sf::Event event;
    while(window.pollEvent(event))
    {
        if(event.type == sf::Event::Closed)
        {
            window.close();
            return;
        }
        for(auto w:widgets)
            w-&gt;handleEvent(event);
    }
}

void Draw()
{
    window.clear(sf::Color::Black);
    for(auto w:widgets)
        window.draw(*w);
    window.display();
}
</code></pre>
<h1><a class="header" href="#butoane" id="butoane">Butoane</a></h1>
<p>Butoanele sunt Widget-uri care apeleaza o functie cand dai click pe ele</p>
<pre><code class="language-cpp">class Button : public Widget
{
public:
    Button(const sf::FloatRect &amp;rect, const std::string &amp;text, sf::Color color);

    void handleEvent(sf::Event event);
    void update();
    void setCallback(std::function&lt;void()&gt; callback);

protected:
    void draw(sf::RenderTarget&amp; target, sf::RenderStates states) const;

private:
    sf::RectangleShape _shape;
    TextArea _text;
    std::function&lt;void()&gt; _callback;
};
</code></pre>
<h1><a class="header" href="#paintarea" id="paintarea">PaintArea</a></h1>
<p>PaintArea Widget-ul pe care desenezi. Acesta este implementat folosind un algoritm de tip fill. Cand dai click pe un pixel al Widget-ului, toti pixelii la o distanta mai mica de marimea brush-ului vor fi colorati in alb.</p>
<p>Odata ce a fost apasat butonul &quot;Calculate&quot;, imaginea desenata va fi transformata intr-o imagine de 28x28 pixeli, ca apoi aceasta sa fie prelucrata in continuare de reteaua neuronala.</p>
<pre><code class="language-cpp">class PaintArea : public Widget
{
public:
    PaintArea(const sf::IntRect &amp;rect);
    ~PaintArea();

    void update();
    void setRadius(float radius);
    void handleEvent(sf::Event event);
    void draw(sf::RenderTarget&amp; target, sf::RenderStates states) const;
    nn::matrix&lt;double&gt; toMatrix(int r,int c);
    void clear();

private:
    void paint(int x0,int y0,int x1,int y1,sf::Color color);
    void setColor(int x,int y,sf::Color color);
    sf::Color getColor(int x,int y);


    sf::Texture _texture;
    sf::Sprite _sprite;
    sf::Uint8 *_pixels;
    sf::Vector2i _point;
    float _radius;
    int _width,_height;
};
</code></pre>
<h1><a class="header" href="#imbunatatiri-posibile" id="imbunatatiri-posibile">Imbunatatiri posibile</a></h1>
<ul>
<li>Acuratetea retelei neuronale este destul de mica. Pentru a rezolva aceasta problema as putea adauga momentum si sa schimb functia de activare din sigmoid in RELU.</li>
<li>Interfata poate fi facuta mai prietenoasa, prin culori mai frumoase, si adaugarea animatiilor.</li>
</ul>
<h1><a class="header" href="#bibliografie" id="bibliografie">Bibliografie</a></h1>
<ul>
<li><a href="https://ro.wikipedia.org/wiki/Re%C8%9Bea_neural%C4%83">Wikipedia</a></li>
<li><a href="http://neuralnetworksanddeeplearning.com/">neuralnetworksanddeeplearning.com</a></li>
<li><a href="https://www.youtube.com/watch?v=aircAruvnKk">Deep learning, de 3blue1brown</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
        
        

    </body>
</html>
